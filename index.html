<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GRAVSHIFT ‚Äî Free Online Gravity Flip Game | Addictive Browser Game</title>
  <meta name="description" content="Play GRAVSHIFT free online! Flip gravity to dodge obstacles in this addictive neon arcade game. No download needed. Beat your high score and challenge friends. New levels added weekly." />
  <meta name="keywords" content="free online game, gravity game, browser game, arcade game, gravshift, endless runner, free game, HTML5 game, addictive game, no download game" />
  <meta name="author" content="GravShift Games" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://yourusername.github.io/gravshift/" />

  <!-- Open Graph / Social -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://yourusername.github.io/gravshift/" />
  <meta property="og:title" content="GRAVSHIFT ‚Äî Free Gravity Flip Arcade Game" />
  <meta property="og:description" content="Flip gravity, dodge obstacles, survive as long as possible. Free browser game, no download. Can you beat 10,000 points?" />
  <meta property="og:image" content="https://yourusername.github.io/gravshift/preview.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="GRAVSHIFT ‚Äî Free Gravity Flip Arcade Game" />
  <meta name="twitter:description" content="Flip gravity. Dodge everything. Survive. Free browser game." />

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "VideoGame",
    "name": "GRAVSHIFT",
    "description": "A free browser-based gravity-flip arcade game where players flip gravity to dodge obstacles and survive as long as possible.",
    "genre": ["Arcade", "Action", "Endless Runner"],
    "playMode": "SinglePlayer",
    "applicationCategory": "Game",
    "operatingSystem": "Any (Browser)",
    "url": "https://yourusername.github.io/gravshift/",
    "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" }
  }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Share+Tech+Mono&display=swap" rel="stylesheet" />

  <!-- Google AdSense ‚Äî replace ca-pub-XXXXXXXXXXXXXXXX with your publisher ID -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3503638702287231" crossorigin="anonymous"></script>

  <style>
    :root {
      --bg: #050810;
      --panel: #0b1020;
      --accent: #00f5d4;
      --accent2: #f72585;
      --accent3: #ffd60a;
      --text: #e0e8ff;
      --muted: #4a5580;
      --glow: 0 0 20px var(--accent);
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Share Tech Mono', monospace;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ STARFIELD BACKGROUND ‚îÄ‚îÄ */
    #stars {
      position: fixed; inset: 0; pointer-events: none; z-index: 0;
      background: radial-gradient(ellipse at 50% 30%, #0d1b3e 0%, #050810 70%);
    }
    .star {
      position: absolute; border-radius: 50%;
      background: white; animation: twinkle var(--d, 3s) infinite alternate ease-in-out;
    }
    @keyframes twinkle { from { opacity: .1; } to { opacity: .9; } }

    /* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
    #app {
      position: relative; z-index: 1;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh; padding: 0 16px 40px;
    }

    /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
    header {
      width: 100%; max-width: 860px;
      display: flex; justify-content: space-between; align-items: center;
      padding: 18px 0 10px;
    }
    .logo {
      font-family: 'Black Ops One', sans-serif;
      font-size: clamp(1.6rem, 4vw, 2.4rem);
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      letter-spacing: 4px;
      text-shadow: none;
      filter: drop-shadow(0 0 12px var(--accent));
    }
    .tagline {
      font-size: .72rem; color: var(--muted); letter-spacing: 2px; text-transform: uppercase;
    }

    /* ‚îÄ‚îÄ AD BANNER (top) ‚îÄ‚îÄ */
    .ad-banner {
      width: 100%; max-width: 860px;
      min-height: 90px;
      background: #0b1020;
      border: 1px solid #1a2040;
      border-radius: 6px;
      display: flex; align-items: center; justify-content: center;
      color: var(--muted); font-size: .75rem; letter-spacing: 1px;
      margin-bottom: 16px;
      overflow: hidden;
    }
    .ad-label { font-size: .6rem; color: var(--muted); margin-bottom: 2px; text-transform: uppercase; letter-spacing: 1px; }

    /* ‚îÄ‚îÄ GAME CONTAINER ‚îÄ‚îÄ */
    #game-wrap {
      width: 100%; max-width: 860px;
      display: flex; gap: 16px; align-items: flex-start;
    }

    #canvas-wrap {
      position: relative; flex: 1;
      border: 1px solid var(--accent);
      border-radius: 8px;
      box-shadow: 0 0 30px rgba(0,245,212,.15), inset 0 0 60px rgba(0,0,0,.6);
      overflow: hidden;
      aspect-ratio: 16/9;
      min-width: 0;
    }

    canvas {
      display: block; width: 100%; height: 100%;
      image-rendering: crisp-edges;
    }

    /* overlays */
    .overlay {
      position: absolute; inset: 0;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      background: rgba(5,8,16,.88);
      backdrop-filter: blur(4px);
      gap: 12px; padding: 20px; text-align: center;
      transition: opacity .3s;
    }
    .overlay.hidden { display: none; }

    .overlay h2 {
      font-family: 'Black Ops One', sans-serif;
      font-size: clamp(1.4rem, 4vw, 2.6rem);
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      filter: drop-shadow(0 0 8px var(--accent));
      letter-spacing: 3px;
    }
    .overlay p { color: var(--muted); font-size: .85rem; line-height: 1.6; max-width: 320px; }
    .overlay .score-display {
      font-family: 'Black Ops One', sans-serif;
      font-size: clamp(2rem, 6vw, 3.5rem);
      color: var(--accent3);
      filter: drop-shadow(0 0 10px var(--accent3));
    }
    .overlay .hi-score { font-size: .85rem; color: var(--accent2); letter-spacing: 2px; }

    .btn {
      font-family: 'Black Ops One', sans-serif;
      font-size: 1rem; letter-spacing: 3px;
      padding: 12px 36px;
      border: 2px solid var(--accent);
      background: transparent; color: var(--accent);
      border-radius: 4px; cursor: pointer;
      transition: all .2s;
      text-transform: uppercase;
    }
    .btn:hover {
      background: var(--accent); color: var(--bg);
      box-shadow: var(--glow);
      transform: scale(1.04);
    }
    .btn.danger { border-color: var(--accent2); color: var(--accent2); }
    .btn.danger:hover { background: var(--accent2); color: var(--bg); box-shadow: 0 0 20px var(--accent2); }

    /* controls hint */
    .controls-hint {
      display: flex; gap: 20px; font-size: .72rem; color: var(--muted); flex-wrap: wrap; justify-content: center;
    }
    .key {
      display: inline-block; border: 1px solid var(--muted);
      border-radius: 3px; padding: 2px 8px; color: var(--text);
      font-family: 'Share Tech Mono', monospace;
    }

    /* scanlines effect */
    #canvas-wrap::after {
      content: '';
      position: absolute; inset: 0; pointer-events: none;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,.08) 2px, rgba(0,0,0,.08) 4px);
      z-index: 10;
    }

    /* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
    #sidebar {
      width: 180px; flex-shrink: 0;
      display: flex; flex-direction: column; gap: 12px;
    }

    .stat-box {
      background: var(--panel);
      border: 1px solid #1a2040;
      border-radius: 6px;
      padding: 14px;
      display: flex; flex-direction: column; gap: 4px;
    }
    .stat-label { font-size: .6rem; color: var(--muted); letter-spacing: 2px; text-transform: uppercase; }
    .stat-value {
      font-family: 'Black Ops One', sans-serif;
      font-size: 1.6rem; color: var(--accent3);
      filter: drop-shadow(0 0 6px var(--accent3));
    }
    .stat-value.live { color: var(--accent); filter: drop-shadow(0 0 6px var(--accent)); }

    .sidebar-ad {
      background: var(--panel);
      border: 1px solid #1a2040;
      border-radius: 6px;
      min-height: 250px;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      color: var(--muted); font-size: .7rem; letter-spacing: 1px;
      gap: 6px; padding: 12px; text-align: center;
    }

    .leaderboard { background: var(--panel); border: 1px solid #1a2040; border-radius: 6px; padding: 14px; }
    .leaderboard h3 { font-family: 'Black Ops One', sans-serif; font-size: .75rem; color: var(--accent2); letter-spacing: 2px; margin-bottom: 10px; }
    .lb-row { display: flex; justify-content: space-between; font-size: .72rem; padding: 3px 0; border-bottom: 1px solid #0f1530; }
    .lb-rank { color: var(--muted); min-width: 20px; }
    .lb-name { color: var(--text); flex: 1; padding: 0 6px; }
    .lb-pts { color: var(--accent3); }

    .tip-box {
      background: var(--panel); border: 1px solid #1a2040; border-radius: 6px; padding: 12px;
      font-size: .68rem; color: var(--muted); line-height: 1.5;
    }
    .tip-box span { color: var(--accent); }

    /* ‚îÄ‚îÄ INFO SECTION ‚îÄ‚îÄ */
    #info {
      width: 100%; max-width: 860px; margin-top: 24px;
      display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
    }
    .info-card {
      background: var(--panel); border: 1px solid #1a2040; border-radius: 8px; padding: 20px;
    }
    .info-card h2 {
      font-family: 'Black Ops One', sans-serif; font-size: 1rem;
      color: var(--accent); letter-spacing: 2px; margin-bottom: 10px;
    }
    .info-card p, .info-card li {
      font-size: .78rem; color: var(--muted); line-height: 1.7;
    }
    .info-card ul { padding-left: 16px; }
    .info-card li { margin-bottom: 4px; }
    .info-card li span { color: var(--accent3); }

    /* ‚îÄ‚îÄ BOTTOM AD ‚îÄ‚îÄ */
    #bottom-ad {
      width: 100%; max-width: 860px; margin-top: 20px;
      min-height: 90px;
      background: var(--panel); border: 1px solid #1a2040; border-radius: 6px;
      display: flex; align-items: center; justify-content: center;
      color: var(--muted); font-size: .75rem; letter-spacing: 1px;
    }

    /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
    footer {
      width: 100%; max-width: 860px; margin-top: 20px;
      border-top: 1px solid #1a2040; padding-top: 16px;
      display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px;
      font-size: .68rem; color: var(--muted);
    }
    footer a { color: var(--muted); text-decoration: none; }
    footer a:hover { color: var(--accent); }

    /* share buttons */
    .share-row { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; }
    .share-btn {
      font-family: 'Share Tech Mono', monospace;
      font-size: .7rem; padding: 6px 14px;
      border-radius: 4px; cursor: pointer; border: none;
      transition: transform .15s, opacity .15s;
    }
    .share-btn:hover { transform: scale(1.06); opacity: .9; }
    .tw { background: #1DA1F2; color: #fff; }
    .fb { background: #1877F2; color: #fff; }
    .wa { background: #25D366; color: #fff; }

    /* mobile */
    @media (max-width: 640px) {
      #game-wrap { flex-direction: column; }
      #sidebar { width: 100%; flex-direction: row; flex-wrap: wrap; }
      .stat-box { flex: 1; min-width: 100px; }
      .sidebar-ad { display: none; }
      #info { grid-template-columns: 1fr; }
    }

    /* particle flash */
    @keyframes flash { 0%,100%{opacity:0} 50%{opacity:1} }
  </style>
</head>
<body>

<div id="stars"></div>

<div id="app">
  <header>
    <div>
      <div class="logo">GRAVSHIFT</div>
      <div class="tagline">Flip Gravity. Defy Physics. Survive.</div>
    </div>
    <div class="share-row">
      <button class="share-btn tw" onclick="shareTwitter()">ùïè Share</button>
      <button class="share-btn wa" onclick="shareWhatsApp()">Share</button>
    </div>
  </header>

  <!-- TOP AD BANNER -->
  <div class="ad-banner" id="top-ad">
    <div style="text-align:center">
      <div class="ad-label">Advertisement</div>
<!-- Top banner -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3503638702287231"
     data-ad-slot="8510326930"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      <span style="font-size:.7rem">[ AdSense 728√ó90 ‚Äî Replace with your AdSense code ]</span>
    </div>
  </div>

  <div id="game-wrap">
    <div id="canvas-wrap">
      <canvas id="gc" width="800" height="450"></canvas>

      <!-- START SCREEN -->
      <div class="overlay" id="screen-start">
        <h2>GRAVSHIFT</h2>
        <p>Flip gravity to dodge the obstacles.<br/>How long can you survive?</p>
        <div class="controls-hint">
          <span><span class="key">SPACE</span> / <span class="key">‚Üë</span> / <span class="key">TAP</span> ‚Äî Flip gravity</span>
        </div>
        <button class="btn" onclick="startGame()">START GAME</button>
      </div>

      <!-- GAME OVER SCREEN -->
      <div class="overlay hidden" id="screen-over">
        <h2>GAME OVER</h2>
        <div class="score-display" id="final-score">0</div>
        <div class="hi-score" id="hi-score-display">BEST: 0</div>
        <div class="share-row">
          <button class="share-btn tw" onclick="shareScore()">Share Score</button>
        </div>
        <!-- Interstitial ad placeholder -->
        <div style="width:300px;min-height:60px;background:#0b1020;border:1px solid #1a2040;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:.65rem;color:#4a5580;letter-spacing:1px;">
          [ AdSense 300√ó60 ‚Äî Game Over Ad ]
<!-- Game over overlay -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:60px"
     data-ad-client="ca-pub-3503638702287231"
     data-ad-slot="7684835000"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
        </div>
        <button class="btn danger" onclick="startGame()">PLAY AGAIN</button>
      </div>
    </div>

    <!-- SIDEBAR -->
    <div id="sidebar">
      <div class="stat-box">
        <div class="stat-label">Score</div>
        <div class="stat-value live" id="score-disp">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Best</div>
        <div class="stat-value" id="best-disp">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Level</div>
        <div class="stat-value live" id="level-disp">1</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Flips</div>
        <div class="stat-value" id="flip-disp">0</div>
      </div>

      <!-- SIDEBAR AD (300√ó250) -->
      <div class="sidebar-ad">
        <div class="ad-label">Advertisement</div>
  <!-- Sidebar -->
<ins class="adsbygoogle"
     style="display:inline-block;width:160px;height:240px"
     data-ad-client="ca-pub-3503638702287231"
     data-ad-slot="7468708005"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
        [ AdSense 160√ó240 sidebar ]
      </div>

      <div class="leaderboard">
        <h3>üèÜ Today's Best</h3>
        <div id="lb-rows"></div>
      </div>

      <div class="tip-box">
        <span>üí° TIP:</span> Watch for <span>GOLD</span> blocks ‚Äî they give score bonuses!
      </div>
    </div>
  </div>

  <!-- INFO / SEO CONTENT -->
  <div id="info">
    <div class="info-card">
      <h2>HOW TO PLAY</h2>
      <ul>
        <li><span>SPACE / UP / TAP</span> ‚Äî Flip gravity</li>
        <li>Dodge red spike obstacles</li>
        <li>Collect <span>gold</span> score multiplier blocks</li>
        <li>Speed increases every 500 points</li>
        <li>Survive as long as possible!</li>
        <li>No downloads, plays in any browser</li>
      </ul>
    </div>
    <div class="info-card">
      <h2>ABOUT GRAVSHIFT</h2>
      <p>GRAVSHIFT is a free, browser-based gravity-flip arcade game. Control a neon ship navigating an endless corridor ‚Äî flip between the top and bottom walls to avoid a relentless stream of obstacles. Each level increases speed and obstacle density, making every run a unique challenge. Perfect for short sessions or obsessive score-chasing.</p>
    </div>
    <div class="info-card">
      <h2>TIPS & STRATEGY</h2>
      <ul>
        <li>Don't panic-flip ‚Äî plan 2 moves ahead</li>
        <li>Narrow gaps appear after level 3</li>
        <li>Gold blocks reset your combo timer</li>
        <li><span>Rhythm</span> beats reflexes ‚Äî find your flow</li>
        <li>The center is safest early on</li>
      </ul>
    </div>
    <div class="info-card">
      <h2>UPDATES & FEATURES</h2>
      <ul>
        <li>üÜï Obstacle variety with 5 patterns</li>
        <li>üéÆ Works on mobile (tap to flip)</li>
        <li>üíæ High score saved in browser</li>
        <li>‚ö° Procedurally generated levels</li>
        <li>More coming ‚Äî bookmark &amp; return!</li>
      </ul>
    </div>
  </div>

  <!-- BOTTOM AD -->
  <div id="bottom-ad">
    <div style="text-align:center">
      <div class="ad-label">Advertisement</div>
<!-- Bottom banner -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-3503638702287231"
     data-ad-slot="5034620935"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      [ AdSense 728√ó90 bottom banner ]
    </div>
  </div>

  <footer>
    <span>¬© 2025 GRAVSHIFT ‚Äî Free Browser Games</span>
    <span>
      <a href="#how-to-play">How to Play</a> ¬∑
      <a href="mailto:you@email.com">Contact</a> ¬∑
      <a href="#privacy">Privacy</a>
    </span>
  </footer>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STARFIELD
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const starsEl = document.getElementById('stars');
for (let i = 0; i < 120; i++) {
  const s = document.createElement('div');
  s.className = 'star';
  const sz = Math.random() * 2.5;
  s.style.cssText = `width:${sz}px;height:${sz}px;top:${Math.random()*100}%;left:${Math.random()*100}%;--d:${(2+Math.random()*4).toFixed(1)}s;opacity:${Math.random()*.6+.1}`;
  starsEl.appendChild(s);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   GAME ENGINE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const canvas = document.getElementById('gc');
const ctx = canvas.getContext('2d');
const W = 800, H = 450;

// --- State ---
let state = 'start'; // start | play | dead
let score, hiScore, flips, level, gameSpeed, frame;
let gravDir; // 1 = down, -1 = up
let shipY, shipVY;
let particles;
let obstacles;
let bonuses;
let bgOffset;
let comboTimer, combo;
let flipCooldown;
let animId;

const SHIP_X = 140;
const SHIP_H = 22, SHIP_W = 34;
const CEILING_H = 36, FLOOR_H = 36;
const PLAY_TOP = CEILING_H, PLAY_BOTTOM = H - FLOOR_H;
const PLAY_H = PLAY_BOTTOM - PLAY_TOP;

const GRAV = 0.42;
const FLIP_VEL = 6.2;
const BASE_SPEED = 3.2;

try { hiScore = parseInt(localStorage.getItem('gravshift_hi') || '0'); } catch(e) { hiScore = 0; }

function resetGame() {
  score = 0; flips = 0; level = 1; frame = 0;
  gameSpeed = BASE_SPEED;
  gravDir = 1;
  shipY = H / 2 - SHIP_H / 2;
  shipVY = 0;
  particles = [];
  obstacles = [];
  bonuses = [];
  bgOffset = 0;
  comboTimer = 0; combo = 1;
  flipCooldown = 0;
}

/* ‚îÄ‚îÄ‚îÄ Obstacle Templates ‚îÄ‚îÄ‚îÄ */
function spawnObstacle() {
  const x = W + 40;
  const minGap = Math.max(90, 150 - level * 8);
  const gapH = minGap + Math.random() * 40;
  const gapY = PLAY_TOP + Math.random() * (PLAY_H - gapH);

  const type = Math.floor(Math.random() * 5);
  const w = 22 + Math.random() * 18;

  if (type === 0) {
    // Full wall with gap
    obstacles.push({x, y: PLAY_TOP, w, h: gapY - PLAY_TOP, type: 'wall'});
    obstacles.push({x, y: gapY + gapH, w, h: PLAY_BOTTOM - (gapY + gapH), type: 'wall'});
  } else if (type === 1) {
    // Spike from ceiling
    const sh = 40 + Math.random() * 60;
    obstacles.push({x: x - 10, y: PLAY_TOP, w: 30, h: sh, type: 'spike', from: 'top'});
  } else if (type === 2) {
    // Spike from floor
    const sh = 40 + Math.random() * 60;
    obstacles.push({x: x - 10, y: PLAY_BOTTOM - sh, w: 30, h: sh, type: 'spike', from: 'bot'});
  } else if (type === 3) {
    // Double spikes
    const sh1 = 35 + Math.random() * 40, sh2 = 35 + Math.random() * 40;
    obstacles.push({x: x - 10, y: PLAY_TOP, w: 28, h: sh1, type: 'spike', from: 'top'});
    obstacles.push({x: x - 10, y: PLAY_BOTTOM - sh2, w: 28, h: sh2, type: 'spike', from: 'bot'});
  } else {
    // Moving block
    const bh = 50 + Math.random() * 40;
    const by = gapY;
    obstacles.push({x, y: by, w: 24, h: bh, type: 'moving', vy: (Math.random()>.5?1:-1)*1.2, minY: PLAY_TOP, maxY: PLAY_BOTTOM});
  }

  // Bonus block chance
  if (Math.random() < 0.28) {
    bonuses.push({x: x + Math.random() * 80, y: PLAY_TOP + Math.random() * PLAY_H, w: 18, h: 18, pulse: 0});
  }
}

/* ‚îÄ‚îÄ‚îÄ Particles ‚îÄ‚îÄ‚îÄ */
function burst(x, y, color, n = 12) {
  for (let i = 0; i < n; i++) {
    const angle = Math.random() * Math.PI * 2;
    const spd = 1.5 + Math.random() * 4;
    particles.push({
      x, y,
      vx: Math.cos(angle) * spd,
      vy: Math.sin(angle) * spd,
      life: 1, decay: .03 + Math.random() * .04,
      r: 2 + Math.random() * 3,
      color
    });
  }
}

/* ‚îÄ‚îÄ‚îÄ Draw Functions ‚îÄ‚îÄ‚îÄ */
function drawBG() {
  // Grid lines
  ctx.save();
  ctx.strokeStyle = 'rgba(0,245,212,0.05)';
  ctx.lineWidth = 1;
  const gridSz = 50;
  const off = bgOffset % gridSz;
  for (let x = -off; x < W + gridSz; x += gridSz) {
    ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, H); ctx.stroke();
  }
  for (let y = 0; y < H; y += gridSz) {
    ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(W, y); ctx.stroke();
  }
  ctx.restore();
}

function drawBorders() {
  // Ceiling
  const cg = ctx.createLinearGradient(0, 0, 0, CEILING_H);
  cg.addColorStop(0, gravDir === -1 ? 'rgba(247,37,133,0.9)' : 'rgba(0,245,212,0.9)');
  cg.addColorStop(1, 'rgba(5,8,16,0)');
  ctx.fillStyle = cg;
  ctx.fillRect(0, 0, W, CEILING_H);
  // edge line
  ctx.strokeStyle = gravDir === -1 ? '#f72585' : '#00f5d4';
  ctx.lineWidth = 2;
  ctx.shadowColor = gravDir === -1 ? '#f72585' : '#00f5d4';
  ctx.shadowBlur = 8;
  ctx.beginPath(); ctx.moveTo(0, CEILING_H); ctx.lineTo(W, CEILING_H); ctx.stroke();

  // Floor
  const fg = ctx.createLinearGradient(0, PLAY_BOTTOM, 0, H);
  fg.addColorStop(0, 'rgba(5,8,16,0)');
  fg.addColorStop(1, gravDir === 1 ? 'rgba(247,37,133,0.9)' : 'rgba(0,245,212,0.9)');
  ctx.fillStyle = fg;
  ctx.fillRect(0, PLAY_BOTTOM, W, FLOOR_H);
  ctx.strokeStyle = gravDir === 1 ? '#f72585' : '#00f5d4';
  ctx.shadowColor = gravDir === 1 ? '#f72585' : '#00f5d4';
  ctx.beginPath(); ctx.moveTo(0, PLAY_BOTTOM); ctx.lineTo(W, PLAY_BOTTOM); ctx.stroke();

  ctx.shadowBlur = 0;
}

function drawShip() {
  const sx = SHIP_X - SHIP_W / 2;
  const sy = shipY;
  const flip = gravDir === -1;

  ctx.save();
  ctx.translate(SHIP_X, sy + SHIP_H / 2);
  if (flip) ctx.scale(1, -1);

  // Glow
  ctx.shadowColor = '#00f5d4';
  ctx.shadowBlur = 18;

  // Body
  ctx.fillStyle = '#00f5d4';
  ctx.beginPath();
  ctx.moveTo(-SHIP_W/2 + 4, -SHIP_H/2);
  ctx.lineTo(SHIP_W/2 - 2, 0);
  ctx.lineTo(-SHIP_W/2 + 4, SHIP_H/2);
  ctx.lineTo(-SHIP_W/2 - 4, 0);
  ctx.closePath();
  ctx.fill();

  // Wing accents
  ctx.fillStyle = '#f72585';
  ctx.beginPath();
  ctx.moveTo(-SHIP_W/2 + 4, -SHIP_H/2);
  ctx.lineTo(-4, -4);
  ctx.lineTo(-SHIP_W/2 - 4, 0);
  ctx.closePath();
  ctx.fill();

  // Engine trail
  ctx.shadowBlur = 0;
  for (let i = 0; i < 3; i++) {
    const alpha = (.4 - i * .1) * (0.6 + Math.sin(frame * .2 + i) * .4);
    ctx.fillStyle = `rgba(247,37,133,${alpha})`;
    ctx.beginPath();
    ctx.ellipse(-SHIP_W/2 - 4 - i * 8, 0, 4 - i, 3 - i * .5, 0, 0, Math.PI * 2);
    ctx.fill();
  }

  ctx.restore();
}

function drawObstacles() {
  obstacles.forEach(o => {
    ctx.save();
    if (o.type === 'moving') {
      ctx.shadowColor = '#f72585';
      ctx.shadowBlur = 12;
      ctx.fillStyle = '#f72585';
      const grad = ctx.createLinearGradient(o.x, o.y, o.x + o.w, o.y + o.h);
      grad.addColorStop(0, '#f72585');
      grad.addColorStop(1, '#7b0d3e');
      ctx.fillStyle = grad;
      ctx.fillRect(o.x, o.y, o.w, o.h);
      // animated stripe
      ctx.fillStyle = 'rgba(255,255,255,0.1)';
      ctx.fillRect(o.x + 4, o.y + 4, 4, o.h - 8);
    } else {
      ctx.shadowColor = '#f72585';
      ctx.shadowBlur = 10;
      if (o.type === 'spike') {
        // Draw triangle spike
        const fromTop = o.from === 'top';
        ctx.fillStyle = '#f72585';
        const cols = Math.max(1, Math.floor(o.w / 12));
        for (let c = 0; c < cols; c++) {
          const sx = o.x + c * (o.w / cols);
          const sw = o.w / cols - 2;
          ctx.beginPath();
          if (fromTop) {
            ctx.moveTo(sx, o.y);
            ctx.lineTo(sx + sw, o.y);
            ctx.lineTo(sx + sw / 2, o.y + o.h);
          } else {
            ctx.moveTo(sx, o.y + o.h);
            ctx.lineTo(sx + sw, o.y + o.h);
            ctx.lineTo(sx + sw / 2, o.y);
          }
          ctx.closePath();
          ctx.fill();
        }
      } else {
        const grad = ctx.createLinearGradient(o.x, o.y, o.x + o.w, o.y + o.h);
        grad.addColorStop(0, '#b5179e');
        grad.addColorStop(1, '#480058');
        ctx.fillStyle = grad;
        ctx.fillRect(o.x, o.y, o.w, o.h);
        // Edge highlight
        ctx.strokeStyle = 'rgba(247,37,133,0.5)';
        ctx.lineWidth = 1; ctx.shadowBlur = 0;
        ctx.strokeRect(o.x, o.y, o.w, o.h);
      }
    }
    ctx.restore();
  });
}

function drawBonuses() {
  bonuses.forEach(b => {
    b.pulse += 0.08;
    const glow = 8 + Math.sin(b.pulse) * 4;
    ctx.save();
    ctx.shadowColor = '#ffd60a';
    ctx.shadowBlur = glow;
    ctx.fillStyle = `rgba(255,214,10,${0.7 + Math.sin(b.pulse) * .3})`;
    ctx.fillRect(b.x - b.w/2, b.y - b.h/2, b.w, b.h);
    ctx.strokeStyle = '#fff';
    ctx.lineWidth = 1;
    ctx.strokeRect(b.x - b.w/2, b.y - b.h/2, b.w, b.h);
    // star symbol
    ctx.fillStyle = '#fff';
    ctx.font = `bold ${b.h * .7}px monospace`;
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillText('‚òÖ', b.x, b.y);
    ctx.restore();
  });
}

function drawParticles() {
  particles.forEach(p => {
    ctx.save();
    ctx.globalAlpha = p.life;
    ctx.fillStyle = p.color;
    ctx.shadowColor = p.color; ctx.shadowBlur = 6;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r * p.life, 0, Math.PI * 2);
    ctx.fill();
    ctx.restore();
  });
}

function drawHUD() {
  ctx.fillStyle = 'rgba(0,245,212,0.9)';
  ctx.font = 'bold 15px "Share Tech Mono"';
  ctx.textAlign = 'left'; ctx.textBaseline = 'top';
  ctx.shadowColor = '#00f5d4'; ctx.shadowBlur = 8;
  ctx.fillText(`SCORE: ${score}`, 14, 8);
  ctx.shadowBlur = 0;

  if (combo > 1) {
    ctx.fillStyle = '#ffd60a';
    ctx.font = 'bold 12px "Share Tech Mono"';
    ctx.fillText(`x${combo} COMBO`, 14, 26);
  }

  ctx.textAlign = 'right';
  ctx.fillStyle = 'rgba(100,120,180,0.7)';
  ctx.font = '12px "Share Tech Mono"';
  ctx.fillText(`LVL ${level}`, W - 14, 8);
}

/* ‚îÄ‚îÄ‚îÄ Collision ‚îÄ‚îÄ‚îÄ */
function hitTest(ax, ay, aw, ah, bx, by, bw, bh) {
  return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;
}

/* ‚îÄ‚îÄ‚îÄ Main Loop ‚îÄ‚îÄ‚îÄ */
function gameLoop() {
  if (state !== 'play') return;
  frame++;

  // Clear
  ctx.clearRect(0, 0, W, H);
  ctx.fillStyle = '#050810';
  ctx.fillRect(0, 0, W, H);

  drawBG();
  bgOffset += gameSpeed;

  // Physics
  flipCooldown = Math.max(0, flipCooldown - 1);
  shipVY += GRAV * gravDir;
  shipVY *= 0.98; // slight damping
  shipY += shipVY;

  // Wall collision
  if (shipY < PLAY_TOP) { shipY = PLAY_TOP; shipVY = 0; burst(SHIP_X, PLAY_TOP, '#f72585', 6); die(); return; }
  if (shipY + SHIP_H > PLAY_BOTTOM) { shipY = PLAY_BOTTOM - SHIP_H; shipVY = 0; burst(SHIP_X, PLAY_BOTTOM, '#f72585', 6); die(); return; }

  // Spawn obstacles
  const spawnInterval = Math.max(55, 110 - level * 5);
  if (frame % spawnInterval === 0) spawnObstacle();

  // Update obstacles
  for (let i = obstacles.length - 1; i >= 0; i--) {
    const o = obstacles[i];
    o.x -= gameSpeed;
    if (o.type === 'moving') {
      o.y += o.vy;
      if (o.y <= o.minY || o.y + o.h >= o.maxY) o.vy *= -1;
    }
    if (o.x + (o.w || 30) < -10) { obstacles.splice(i, 1); continue; }

    // Collision with ship
    if (hitTest(SHIP_X - SHIP_W/2 + 5, shipY + 4, SHIP_W - 10, SHIP_H - 8,
                o.x, o.y, o.w, o.h)) {
      burst(SHIP_X, shipY + SHIP_H/2, '#f72585', 20);
      burst(SHIP_X, shipY + SHIP_H/2, '#00f5d4', 10);
      die(); return;
    }
  }

  // Bonuses
  for (let i = bonuses.length - 1; i >= 0; i--) {
    const b = bonuses[i];
    b.x -= gameSpeed;
    if (b.x < -20) { bonuses.splice(i, 1); continue; }
    if (hitTest(SHIP_X - SHIP_W/2 + 4, shipY + 4, SHIP_W - 8, SHIP_H - 8,
                b.x - b.w/2, b.y - b.h/2, b.w, b.h)) {
      combo = Math.min(combo + 1, 8);
      comboTimer = 180;
      score += 50 * combo;
      burst(b.x, b.y, '#ffd60a', 16);
      bonuses.splice(i, 1);
    }
  }

  // Combo decay
  if (comboTimer > 0) { comboTimer--; } else { combo = 1; }

  // Score
  score += Math.floor(gameSpeed * 0.15);
  level = Math.floor(score / 500) + 1;
  gameSpeed = BASE_SPEED + (level - 1) * 0.35;

  // Update particles
  for (let i = particles.length - 1; i >= 0; i--) {
    const p = particles[i];
    p.x += p.vx; p.y += p.vy; p.life -= p.decay;
    if (p.life <= 0) particles.splice(i, 1);
  }

  // Draw everything
  drawObstacles();
  drawBonuses();
  drawParticles();
  drawShip();
  drawBorders();
  drawHUD();

  // Update UI
  document.getElementById('score-disp').textContent = score;
  document.getElementById('level-disp').textContent = level;
  document.getElementById('flip-disp').textContent = flips;

  animId = requestAnimationFrame(gameLoop);
}

function die() {
  state = 'dead';
  cancelAnimationFrame(animId);
  if (score > hiScore) {
    hiScore = score;
    try { localStorage.setItem('gravshift_hi', hiScore); } catch(e){}
  }
  document.getElementById('final-score').textContent = score;
  document.getElementById('hi-score-display').textContent = 'BEST: ' + hiScore;
  document.getElementById('best-disp').textContent = hiScore;
  document.getElementById('screen-over').classList.remove('hidden');
  updateLeaderboard(score);
}

/* ‚îÄ‚îÄ‚îÄ Start/Restart ‚îÄ‚îÄ‚îÄ */
function startGame() {
  document.getElementById('screen-start').classList.add('hidden');
  document.getElementById('screen-over').classList.add('hidden');
  resetGame();
  state = 'play';
  document.getElementById('best-disp').textContent = hiScore;
  animId = requestAnimationFrame(gameLoop);
}

/* ‚îÄ‚îÄ‚îÄ Input ‚îÄ‚îÄ‚îÄ */
function flipGravity() {
  if (state !== 'play') return;
  if (flipCooldown > 0) return;
  flipCooldown = 12;
  gravDir *= -1;
  flips++;
  shipVY = -FLIP_VEL * gravDir;
  burst(SHIP_X, shipY + SHIP_H/2, '#00f5d4', 8);
}

document.addEventListener('keydown', e => {
  if (e.code === 'Space' || e.code === 'ArrowUp') { e.preventDefault(); flipGravity(); }
});
canvas.parentElement.addEventListener('pointerdown', e => {
  if (state !== 'play') return;
  flipGravity();
});

/* ‚îÄ‚îÄ‚îÄ Leaderboard (local session) ‚îÄ‚îÄ‚îÄ */
let lb = [];
function updateLeaderboard(s) {
  const names = ['ACE', 'ZAX', 'ORB', 'NEX', 'SYN', 'VYX', 'KAI', 'RIX', 'LUX', 'ION'];
  // seed some fake local scores first time
  if (lb.length === 0) {
    lb = names.slice(0,7).map((n,i) => ({name: n, pts: Math.floor(2000 - i*180 + Math.random()*80)}));
  }
  lb.push({name: 'YOU', pts: s});
  lb.sort((a,b)=>b.pts-a.pts);
  lb = lb.slice(0,7);
  const container = document.getElementById('lb-rows');
  container.innerHTML = lb.map((r,i)=>`
    <div class="lb-row">
      <span class="lb-rank">${i+1}</span>
      <span class="lb-name" style="${r.name==='YOU'?'color:var(--accent3)':''}">${r.name}</span>
      <span class="lb-pts">${r.pts}</span>
    </div>
  `).join('');
}
updateLeaderboard(0);

/* ‚îÄ‚îÄ‚îÄ Share ‚îÄ‚îÄ‚îÄ */
function shareTwitter() {
  window.open(`https://twitter.com/intent/tweet?text=I%20just%20scored%20${score||0}%20points%20on%20GRAVSHIFT!%20Can%20you%20beat%20me?%20%F0%9F%9A%80&url=https://yourusername.github.io/gravshift/`, '_blank');
}
function shareWhatsApp() {
  window.open(`https://wa.me/?text=Play%20GRAVSHIFT%20free%20online%3A%20https://yourusername.github.io/gravshift/%20‚Äî%20I%20scored%20${score||0}%20points!`, '_blank');
}
function shareScore() {
  window.open(`https://twitter.com/intent/tweet?text=I%20scored%20${score}%20in%20GRAVSHIFT!%20%F0%9F%8E%AE%20Can%20you%20beat%20it%3F&url=https://yourusername.github.io/gravshift/`, '_blank');
}

// Initial draw
ctx.fillStyle = '#050810';
ctx.fillRect(0, 0, W, H);
</script>
</body>
</html>
